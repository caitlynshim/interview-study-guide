## Interview-Prep Web App â€“ Comprehensive Testing Plan (v1.0)

### Purpose
Ensure the customer experience documented in *requirements.txt* remains intact as the codebase evolves. The plan follows a **thin-slice, incremental** approach: we write and stabilise one logical group of tests at a time, committing only when the suite is green.

---
### Testing Principles
1. **Customer-centric** â€“ validate behaviour observable by users, not internal implementation.
2. **Fast & deterministic** â€“ tests must run headlessly in CI under <60 s with no external prompts.
3. **Isolated** â€“ each test seeds/tears down its own data; the order of execution is irrelevant.
4. **Single reason to fail** â€“ each describes exactly one expectation.
5. **Living documentation** â€“ this file is updated whenever tests are added/changed.

---
### Tooling Stack
| Layer              | Library             | Notes |
|--------------------|---------------------|-------|
| Unit / Integration | **Jest**            | Default runner + coverage |
| React UI           | **@testing-library/react** | DOM-oriented assertions |
| API Integration    | **supertest**       | Runs handlers via Next.js test server |
| End-to-End (later) | **Playwright**      | Scriptable, headless E2E; _phase-3_ |
| Fixtures           | **mongodb-memory-server** | Spawns in-memory MongoDB for isolation |
| Coverage           | built-in Istanbul   | Gate â‰¥ 80 % statements on main modules |

---
### Phased Roadmap
Each phase corresponds to a distinct area of the product. We will implement **all** tests in Phase-1 before unlocking Phase-2, etc.

| Phase | Area / Feature (from requirements) | Test Types | Status |
|-------|------------------------------------|------------|--------|
| 1     | Navigation Bar                     | Unit / React | âœ” complete |
| 2     | **Answer a Question** flow         | React, API int. | âœ” complete |
| 3     | **Generate Answer (RAG)** pipeline | API unit/int. | âœ” complete |
| 4     | **Add Experience** form            | React, API int. | âœ” complete |
| 5     | **Navigate Experiences** browsing & edit | React, API int. | âœ” complete |
| 6     | **Write-in Answer & Evaluation**   | React, API int. | â˜ pending |
| 7     | **Practice Out Loud** (Speech-to-Text) | API int. | â˜ pending |
| 8     | **Category Migration Script**      | Node script unit | â˜ pending |
| 9     | End-to-End happy path (core flows) | Playwright | â˜ pending |

Status legend: â˜ not started Â· â—” in-progress Â· âœ” complete

---
### Detailed Test Objectives
Below we list concrete test cases per phase. These will be ticked as they are implemented.

#### Phase 1 â€“ Navigation Bar
1. **Navbar renders** on every page with correct title.
2. **Links** highlight the current route.
3. Unknown route â†’ 404 page shows navbar with title.

#### Phase 2 â€“ Answer a Question
4. âœ” Random question loads when button clicked (mock `/api/questions/random`).
5. âœ” Generate button disabled with empty question; enabled otherwise.
6. âœ” Generate Answer shows animated spinner during request.
7. âœ” Successful response renders markdown answer blocks.
8. âœ” Error response shows toast and no answer block.
9. âœ” Reset button clears state and re-enables inputs.

#### Phase 3 â€“ RAG Pipeline (API)
10. âœ” `/api/experiences/generate` returns answer that includes at least one snippet & reference link.
11. âœ” Vector search index param (`index`) is passed in aggregation.
12. âœ” Returns 400 if question missing.

#### Phase 4 â€“ Add Experience Form
13. âœ” Form validation prevents submission of empty title/content.
14. âœ” Successful POST displays success toast and redirects to Navigate page.
15. âœ” Category auto-assignment occurs (mock OpenAI) and is stored.

#### Phase 5 â€“ Navigate Experiences
16. Experiences list fetches from `/api/experiences/list` and renders cards.
17. Category dropdown filters list.
18. Clicking card expands details; second click collapses.
19. Edit button opens pre-filled edit form.
20. Successful save shows success message and re-renders card view-only.
21. Failed save keeps form open and displays error.

#### Phase 6 â€“ Write-in & Evaluation
22. Typing answer then Evaluate calls `/api/experiences/evaluate` and displays feedback markdown.
23. Similarity check calls `/api/experiences/find-similar` and shows prompt when > 0.8.

#### Phase 7 â€“ Practice Out Loud
24. Upload of recorded audio calls `/api/experiences/transcribe` and shows transcription.
25. Error uploading empty file returns helpful error.

#### Phase 8 â€“ Migration Script
26. `scripts/migrate-categories.js --dry-run` outputs proposed updates without writes.
27. `--write` flag updates documents (mocked MongoDB).

#### Phase 9 â€“ End-to-End
28. Full happy path: add experience â†’ answer question â†’ edit mapped experience â†’ see changes in Navigate page.

---
### Implementation Workflow
1. **Create tests for Phase-1** inside `__tests__/phase1_navbar.test.js`.
2. Run `npm test`; ensure suite passes.
3. Mark corresponding objectives as âœ” in this file.
4. Push commit.
5. Repeat for next phase.

---
### Next Action
We will now implement **Phase-1 Navigation Bar tests**. 

# Testing Strategy and Plan for Interview Prep App

## Overview
This document outlines a comprehensive testing strategy for the Next.js interview preparation web application that uses MongoDB Atlas and OpenAI for RAG functionality.

## Test Plan Phases

### âœ… Phase 1: Navigation Bar (COMPLETE)
**Objective 1:** Test navbar links and navigation between pages
**Objective 2:** Test responsive behavior and active states
**Objective 3:** Test navbar component rendering
- Status: âœ… COMPLETE (3 tests)

### âœ… Phase 2: Answer a Question Flow (COMPLETE)
**Objective 4:** Test question fetching from database
**Objective 5:** Test category filtering functionality
**Objective 6:** Test answer generation via OpenAI integration
**Objective 7:** Test experience finding and evaluation
- Status: âœ… COMPLETE (4 tests)

### âœ… Phase 3: RAG Pipeline API Integration (COMPLETE)
**Objective 8:** Test `/api/questions/categories` endpoint
**Objective 9:** Test `/api/questions/random` endpoint with category filtering
**Objective 10:** Test `/api/experiences/generate` endpoint with OpenAI integration
**Objective 11:** Test `/api/experiences/find-similar` endpoint with vector similarity
**Objective 12:** Test `/api/experiences/evaluate` endpoint with detailed feedback
- Status: âœ… COMPLETE (7 tests)

### âœ… Phase 4: Add Experience Form (COMPLETE)
**Objective 13:** âœ… Test form validation and submission
**Objective 14:** âœ… Test `/api/experiences/add` endpoint
**Objective 15:** âœ… Test OpenAI category generation and embedding creation
- Status: âœ… COMPLETE (15 tests)

### âœ… Phase 5: Navigate Experiences (COMPLETE)
**Objective 16:** âœ… Test experiences list display and filtering
**Objective 17:** âœ… Test experience expansion/collapse functionality
**Objective 18:** âœ… Test inline editing of experiences
**Objective 19:** âœ… Test `/api/experiences/list` endpoint with category filtering
**Objective 20:** âœ… Test `/api/experiences/edit` endpoint with validation and embedding updates
- Status: âœ… COMPLETE (31 tests: 14 React + 17 API)

### ðŸ”„ Phase 6: Write-in Answer & Evaluation (IN PROGRESS)
**Objective 21:** Test answer input and submission
**Objective 22:** Test real-time evaluation feedback
**Objective 23:** Test answer improvement suggestions
- Status: ðŸ”„ PENDING

### ðŸ“‹ Phase 7: Practice Out Loud (PENDING)
**Objective 24:** Test voice recording functionality
**Objective 25:** Test audio transcription via OpenAI Whisper
**Objective 26:** Test transcribed answer evaluation
- Status: ðŸ“‹ PENDING

### ðŸ“‹ Phase 8: Category Migration Script (PENDING)
**Objective 27:** Test database migration for category normalization
**Objective 28:** Test data integrity after migration
- Status: ðŸ“‹ PENDING

### ðŸ“‹ Phase 9: End-to-End Testing (PENDING)
**Objective 29:** Test complete user workflows
**Objective 30:** Test error handling and edge cases
**Objective 31:** Test performance under load
- Status: ðŸ“‹ PENDING

## Current Progress Summary

| Phase | Name | Status | Tests | Completion |
|-------|------|--------|-------|------------|
| 1 | Navigation Bar | âœ… | 3 | 100% |
| 2 | Answer a Question | âœ… | 4 | 100% |
| 3 | RAG Pipeline API | âœ… | 7 | 100% |
| 4 | Add Experience | âœ… | 15 | 100% |
| 5 | Navigate Experiences | âœ… | 31 | 100% |
| 6 | Write-in Answer | ðŸ”„ | 0 | 0% |
| 7 | Practice Out Loud | ðŸ“‹ | 0 | 0% |
| 8 | Category Migration | ðŸ“‹ | 0 | 0% |
| 9 | End-to-End | ðŸ“‹ | 0 | 0% |

**Total Tests:** 60 tests across 5 completed phases
**Overall Progress:** 5/9 phases complete (55.6%) 